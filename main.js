(()=>{"use strict";class e{constructor(e,t=null){this.title=e,this.projectId=t,this.id=(new Date).getTime()}}let t=JSON.parse(localStorage.getItem("tasks"))||[];const n=(e=null)=>{const n=document.getElementById("taskList");n.innerHTML="",(e?t.filter((t=>t.projectId==e)):t).forEach((e=>{const t=document.createElement("li");t.innerHTML=`\n        <i class="fa-regular fa-circle delete-task"></i>\n        <p data-id="${e.id}">${e.title}</p> `,n.appendChild(t)}))};class c{constructor(e){this.name=e,this.id=(new Date).getTime()}}let o=JSON.parse(localStorage.getItem("projects"))||[],s=null;function d(){const e=document.querySelector(".sidebar-projects");e.innerHTML="",o.forEach((t=>{const n=document.createElement("div");n.classList.add("sidebar-item"),n.innerHTML=`\n      <i class="fas fa-folder"></i>\n      <p data-project-id="${t.id}">${t.name}</p>\n      <i class="fas fa-times delete-project"></i>`,e.appendChild(n)}))}function l(e="Home"){const t=document.getElementById("projectTitle");t&&(t.textContent=e)}let i=null;const a=document.getElementById("editTaskModal"),r=a.querySelector(".close"),u=a.querySelector("#saveEdit"),m=a.querySelector("#cancelEdit"),p=a.querySelector("#newTaskTitle");r.onclick=function(){a.style.display="none"},window.onclick=function(e){e.target===a&&(a.style.display="none")},document.querySelector(".home-btn").addEventListener("click",(function(e){l("Home"),s=null,n()})),document.querySelector(".sidebar").addEventListener("click",(function(e){const t=e.target.getAttribute("data-project-id");t&&(l(o.find((e=>e.id==t)).name),s=t,n(t))})),i=function(e,c){const o=t.find((t=>t.id===e));o&&(o.title=c,localStorage.setItem("tasks",JSON.stringify(t)),n(s))},document.addEventListener("DOMContentLoaded",(()=>{l(),n(),d(),document.querySelector(".add-project").addEventListener("click",(function(){this.style.display="none";const e=document.createElement("input");e.type="text",e.placeholder="Enter project name",e.id="new-project-name",e.classList.add("project-input");const t=document.createElement("button");t.innerHTML="Save",t.classList.add("save-project");const n=document.createElement("button");n.innerHTML="Cancel",n.classList.add("cancel-project");const s=document.querySelector(".sidebar");s.appendChild(e),s.appendChild(t),s.appendChild(n),t.addEventListener("click",(()=>{const s=e.value;s&&(function(e){const t=new c(e);o.push(t),localStorage.setItem("projects",JSON.stringify(o))}(s),d(),e.remove(),t.remove(),n.remove(),document.querySelector(".add-project").style.display="flex")})),n.addEventListener("click",(()=>{e.remove(),t.remove(),n.remove(),document.querySelector(".add-project").style.display="flex"}))})),document.querySelector(".sidebar-projects").addEventListener("click",(function(e){e.target.classList.contains("delete-project")&&function(e){if(0===t.filter((t=>t.projectId==e)).length){const t=o.findIndex((t=>t.id===e));t>-1&&(o.splice(t,1),localStorage.setItem("projects",JSON.stringify(o)),d())}else alert("Cannot delete a project that has tasks.")}(parseInt(e.target.previousElementSibling.getAttribute("data-project-id"),10))})),document.getElementById("taskList").addEventListener("click",(function(e){e.target.classList.contains("delete-task")&&(function(e){const n=t.findIndex((t=>t.id===e));n>-1?(t.splice(n,1),localStorage.setItem("tasks",JSON.stringify(t)),console.log("In theory, task deleted")):console.warn(`Task with ID ${e} not found.`)}(parseInt(e.target.nextElementSibling.getAttribute("data-id"),10)),s?n(s):n())})),console.log("addTaskClick executed"),document.getElementById("add-task-button").addEventListener("click",(function(){this.style.display="none",console.log("Add Task Button clicked"),document.querySelector(".add-task-section").style.display="block"})),document.getElementById("addButton").addEventListener("click",(function(){const c=document.getElementById("taskInput"),o=c.value;o&&(function(c,o=null){const d=new e(c,o);t.push(d),localStorage.setItem("tasks",JSON.stringify(t)),s?n(s):n()}(o,s),n(s),c.value=""),document.querySelector(".add-task-section").style.display="none",document.getElementById("add-task-button").style.display="block"})),document.getElementById("cancelButton").addEventListener("click",(function(){document.querySelector(".add-task-section").style.display="none",document.getElementById("add-task-button").style.display="block"}))})),document.getElementById("taskList").addEventListener("click",(function(e){if("P"===e.target.tagName){const t=parseInt(e.target.getAttribute("data-id"),10),n=e.target.textContent;t&&function(e,t){p.value=t,a.style.display="block",u.onclick=function(){const t=p.value;""!==t.trim()&&(i(e,t),a.style.display="none")},m.onclick=function(){a.style.display="none"}}(t,n)}}))})();